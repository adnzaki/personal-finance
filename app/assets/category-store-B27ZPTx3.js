import{al as h,v as u,am as s,L as o,as as l,N as c,at as g,au as m}from"./index-Ce0IJ7ho.js";import{u as i}from"./index-DIENxvLL.js";const p=h("category",{state:()=>({baseUrl:"category/",hideDefault:1,error:{},current:1,showAddForm:!1,showEditForm:!1,disableButton:!1,formTitle:"Tambah Kategori",data:{category_name:"",category_type:"income"}}),actions:{deleteCategory(e){m.create({title:"Hapus Kategori",message:"Anda yakin ingin menghapus kategori ini?",cancel:!0,persistent:!0}).onOk(()=>{const a=c.create({group:!1,spinner:!0,message:"Menghapus kategori...",color:"info",position:"center",timeout:0});o.get(`${this.baseUrl}delete/${e}`,{headers:{Authorization:s}}).then(({data:t})=>{a({timeout:g,message:t.msg,spinner:!1}),t.code===200?a({color:"positive",icon:"done"}):a({color:"negative",icon:"close"}),i().reloadData()}).catch(t=>{console.error(t),a({message:t.message,color:"negative",spinner:!1,timeout:g})})}).onCancel(()=>{})},getDetail(e,a){o.get(`${this.baseUrl}detail/${e}`,{headers:{Authorization:s}}).then(({data:t})=>{this.data=t,this.formTitle="Perbarui Kategori",a()}).catch(t=>{console.error(t)})},save({id:e,afterSuccess:a}){const t=e!==null?`${this.baseUrl}save/${e}`:`${this.baseUrl}save`,n=c.create({group:!1,spinner:!0,message:"Menyimpan kategori...",color:"info",position:"center",timeout:0});o.post(t,this.data,{headers:{Authorization:s},transformRequest:[r=>l(r)]}).then(({data:r})=>{n({timeout:g}),r.code===500?(this.error=r.msg,n({message:"Error! Silakan isi form dengan benar.",color:"negative",spinner:!1})):(this.resetForm(),n({message:r.msg,color:"positive",icon:"done",spinner:!1}),this.data={category_name:"",category_type:"income"},a())})},resetForm(){this.error={},this.current=1,i().reloadData()},toggleDefaultCategory(){o.post(`${this.baseUrl}update-default-visibility`,{value:this.hideDefault},{headers:{Authorization:s},transformRequest:[e=>l(e)]}).then(({data:e})=>{e.code===200&&this.getCategories()})},getDefaultCategorySetting(){o.get(`${this.baseUrl}get-default-category-setting`,{headers:{Authorization:s}}).then(({data:e})=>{this.hideDefault=e.hideDefault})},getCategories(){i().state.rows=25,i().getData({token:s,lang:"indonesia",limit:25,offset:this.current-1,orderBy:"category_type",searchBy:"category_name",sort:"ASC",search:"",url:`${u.apiPublicPath}${this.baseUrl}get-data/`,autoReset:500,afterRequest:()=>{this.getDefaultCategorySetting()}})}}});export{p as u};
