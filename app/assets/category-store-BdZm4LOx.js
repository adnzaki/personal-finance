import{ak as h,as as u,N as l,L as o,al as r,at as g,au as c,t as m}from"./index-DOIfR-E0.js";import{u as i}from"./index-PjOSkoxj.js";const p=h("category",{state:()=>({baseUrl:"category/",hideDefault:1,error:{},current:1,showAddForm:!1,showEditForm:!1,disableButton:!1,formTitle:"Tambah Kategori",data:{category_name:"",category_type:"income"}}),actions:{deleteCategory(e){u.create({title:"Hapus Kategori",message:"Anda yakin ingin menghapus kategori ini?",cancel:!0,persistent:!0}).onOk(()=>{const a=l.create({group:!1,spinner:!0,message:"Menghapus kategori...",color:"info",position:"center",timeout:0});o.get(`${this.baseUrl}delete/${e}`,{headers:{Authorization:r}}).then(({data:t})=>{a({timeout:g,message:t.msg,spinner:!1}),t.code===200?a({color:"positive",icon:"done"}):a({color:"negative",icon:"close"}),i().reloadData()}).catch(t=>{console.error(t),a({message:t.message,color:"negative",spinner:!1,timeout:g})})}).onCancel(()=>{})},getDetail(e,a){o.get(`${this.baseUrl}detail/${e}`,{headers:{Authorization:r}}).then(({data:t})=>{this.data=t,this.formTitle="Perbarui Kategori",a()}).catch(t=>{console.error(t)})},save({id:e,afterSuccess:a}){const t=e!==null?`${this.baseUrl}save/${e}`:`${this.baseUrl}save`,n=l.create({group:!1,spinner:!0,message:"Menyimpan kategori...",color:"info",position:"center",timeout:0});o.post(t,this.data,{headers:{Authorization:r},transformRequest:[s=>c(s)]}).then(({data:s})=>{n({timeout:g}),s.code===500?(this.error=s.msg,n({message:"Error! Silakan isi form dengan benar.",color:"negative",spinner:!1})):(this.resetForm(),n({message:s.msg,color:"positive",icon:"done",spinner:!1}),this.data={category_name:"",category_type:"income"},a())})},resetForm(){this.error={},this.current=1,i().reloadData()},toggleDefaultCategory(){o.post(`${this.baseUrl}update-default-visibility`,{value:this.hideDefault},{headers:{Authorization:r},transformRequest:[e=>c(e)]}).then(({data:e})=>{e.code===200&&this.getCategories()})},getDefaultCategorySetting(){o.get(`${this.baseUrl}get-default-category-setting`,{headers:{Authorization:r}}).then(({data:e})=>{this.hideDefault=e.hideDefault})},getCategories(){i().state.rows=25,i().getData({token:r,lang:"indonesia",limit:25,offset:this.current-1,orderBy:"category_type",searchBy:"category_name",sort:"ASC",search:"",url:`${m.apiPublicPath}${this.baseUrl}get-data/`,autoReset:{active:!0,timeout:500},afterRequest:()=>{this.getDefaultCategorySetting()}})}}});export{p as u};
