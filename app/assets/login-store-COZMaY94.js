import{al as d,r as s,v as u,L as w,as as h,bA as k}from"./index-BEae-QxD.js";const x=d("login",()=>{const i=s(""),r=s(""),c=s(!1),a=s(""),o=s("black"),p=s(!1),f=(t,n)=>{let e=JSON.parse(localStorage.getItem("multiAccounts"))||[];e.some(l=>l.name===t.username)||(e.push({userId:t.id,name:t.username,token:n}),localStorage.setItem("multiAccounts",JSON.stringify(e)))},m=s({}),v=()=>{u.cookieExp*=12*360;let e=new Date().getTime()+u.cookieExp,l=new Date(e);m.value={expires:l.toUTCString(),path:"/",sameSite:"None",secure:!0}},g=()=>JSON.parse(localStorage.getItem("multiAccounts"))||[];function S(t=!0,n=null){let e=g();e=e.filter(l=>t?l.name!==localStorage.getItem("username"):l.name!==n),localStorage.setItem("multiAccounts",JSON.stringify(e))}return{msg:a,showMsg:c,username:i,password:r,msgClass:o,showPassword:p,cookieOptions:m,validate:()=>{a.value="",c.value=!0;const t=()=>c.value=!1;if(i.value===""||r.value==="")a.value="Username dan password wajib diisi",o.value="negative",setTimeout(t,6e3);else{const n={username:i.value,password:r.value};o.value="black",a.value="Memroses autentikasi...",w.post("validate-login",n,{transformRequest:[e=>h(e)]}).then(({data:e})=>{e.status==="failed"?(a.value=e.message,o.value="negative"):(a.value="Login berhasil. Mengalihkan ke halaman utama...",o.value="positive",v(),k.set(u.cookieName,e.token,m.value),f(e.user,e.token),localStorage.setItem("username",e.user.username),localStorage.removeItem("addAccount"),window.location.href=u.homeUrl())}).catch(e=>{a.value=e,o.value="negative",setTimeout(t,6e3)})}},removeAccount:S,setCookieOptions:v,getSavedAccounts:g}});export{x as u};
